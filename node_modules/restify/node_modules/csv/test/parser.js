// Generated by CoffeeScript 1.7.1

/*
Test CSV - Copyright David Worms <open@adaltas.com> (BSD Licensed)
 */

(function() {
  var csv, fs, should;

  fs = require('fs');

  should = require('should');

  csv = process.env.CSV_COV ? require('../lib-cov') : require('../src');

  describe('parser', function() {
    it('should handle empty lines', function(next) {
      var count;
      count = 0;
      return csv().from.string("\n20322051544,1979,8.8017226E7,ABC,45,2000-01-01\n\n28392898392,1974,8.8392926E7,DEF,23,2050-11-27\n").parser.on('row', function(record) {
        if (count === 0) {
          record.should.eql(['20322051544', '1979', '8.8017226E7', 'ABC', '45', '2000-01-01']);
        } else if (count === 1) {
          record.should.eql(['28392898392', '1974', '8.8392926E7', 'DEF', '23', '2050-11-27']);
        } else {
          throw new Error("Invalid record: " + (JSON.stringify(record)));
        }
        count++;
        return record;
      }).on('error', function(err) {
        return next(err);
      }).on('end', function() {
        count.should.eql(2);
        return next();
      });
    });
    return describe('relax', function() {
      return it('work around invalid quotes', function(next) {
        return csv().from.string("384682,\"SAMAY\" Hostel,Jiron \"Florida 285\"", {
          quote: '"',
          escape: '"',
          relax: true
        }).to.array(function(data) {
          data.should.eql([['384682', 'SAMAY Hostel', 'Jiron "Florida 285"']]);
          return next();
        });
      });
    });
  });

}).call(this);

//# sourceMappingURL=parser.map
